<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Dashboard</title>
</head>
<body>

<h2>Dashboard</h2>
<p th:text="'Logged in as: ' + ${user.email}"></p>

<form th:action="@{/logout}" method="post">
    <button type="submit">Logout</button>
</form>

<hr/>

<h3>Stations</h3>

<table border="1" cellpadding="8">
    <thead>
    <tr>
        <th>Station</th>
        <th>Code</th>
        <th>Status</th>
        <th>Action</th>
    </tr>
    </thead>

    <tbody>
    <tr th:each="st : ${stations}">
        <td th:text="${st.stationName}"></td>
        <td th:text="${st.code}"></td>
        <td th:text="${st.active} ? 'Active' : 'Inactive'"></td>

        <td>
            <!-- If subscribed, show Unsubscribe -->
            <div th:if="${subscribedStationIds.contains(st.id)}">
                <form th:action="@{|/subscriptions/${st.id}/unsubscribe|}" method="post">
                    <button type="submit">Unsubscribe</button>
                </form>
            </div>

            <!-- If not subscribed, show Subscribe -->
            <div th:unless="${subscribedStationIds.contains(st.id)}">
                <form th:action="@{|/subscriptions/${st.id}/subscribe|}" method="post">
                    <button type="submit">Subscribe</button>
                </form>
            </div>
        </td>
    </tr>
    </tbody>
</table>

<hr/>

<h3>My Subscriptions</h3>
<ul>
    <li th:each="s : ${subscriptions}"
        th:text="${s.station.stationName} + ' (' + ${s.station.code} + ')'">
    </li>
</ul>

</body>
</html>